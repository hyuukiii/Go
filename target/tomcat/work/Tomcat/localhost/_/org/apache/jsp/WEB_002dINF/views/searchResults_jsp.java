/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.47
 * Generated at: 2025-09-18 07:35:43 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.WEB_002dINF.views;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import Product.ProductDTO;
import java.util.ArrayList;

public final class searchResults_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write('\n');
      out.write('\n');
      out.write('\n');

ArrayList<ProductDTO> searchResults = (ArrayList<ProductDTO>) request.getAttribute("searchResults");
String keyword = (String) request.getAttribute("keyword");
String category = (String) request.getAttribute("category");
String price = (String) request.getAttribute("price");
String status = (String) request.getAttribute("status");
String sort = (String) request.getAttribute("sort");
int currentPage = (Integer) request.getAttribute("currentPage");
int totalPages = (Integer) request.getAttribute("totalPages");
int totalItems = (Integer) request.getAttribute("totalItems");
String userId = (String) session.getAttribute("user_id");

      out.write("\n");
      out.write("<!DOCTYPE html>\n");
      out.write("<html>\n");
      out.write("<head>\n");
      out.write("<meta charset=\"UTF-8\">\n");
      out.write("<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n");
      out.write("<title>검색 결과 - ");
      out.print(keyword != null ? keyword : "전체 상품");
      out.write("</title>\n");
      out.write("<!-- Font Awesome CDN 추가 -->\n");
      out.write("<link rel=\"stylesheet\"\n");
      out.write("\thref=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css\" />\n");
      out.write("<style>\n");
      out.write("body {\n");
      out.write("\tfont-family: 'Arial', sans-serif;\n");
      out.write("\tmargin: 0;\n");
      out.write("\tpadding: 0;\n");
      out.write("\tbackground-color: #f9f9f9;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".header {\n");
      out.write("\tbackground-color: #ffffff;\n");
      out.write("\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n");
      out.write("\tpadding: 15px 20px;\n");
      out.write("\tmargin-bottom: 20px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".header-content {\n");
      out.write("\tdisplay: flex;\n");
      out.write("\talign-items: center;\n");
      out.write("\tjustify-content: space-between;\n");
      out.write("\tmax-width: 1200px;\n");
      out.write("\tmargin: 0 auto;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".header-left {\n");
      out.write("\tdisplay: flex;\n");
      out.write("\talign-items: center;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".header-right {\n");
      out.write("\tdisplay: flex;\n");
      out.write("\talign-items: center;\n");
      out.write("\tgap: 15px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".welcome-msg {\n");
      out.write("\tmargin-right: 10px;\n");
      out.write("\tfont-weight: bold;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".header-btn {\n");
      out.write("\ttext-decoration: none;\n");
      out.write("\tcolor: #333;\n");
      out.write("\tpadding: 5px 10px;\n");
      out.write("\tborder-radius: 4px;\n");
      out.write("\tborder: 1px solid #ddd;\n");
      out.write("\ttransition: all 0.3s;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".header-btn:hover {\n");
      out.write("\tbackground-color: #f5f5f5;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".content {\n");
      out.write("\tmax-width: 1200px;\n");
      out.write("\tmargin: 0 auto;\n");
      out.write("\tpadding: 20px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".search-header {\n");
      out.write("\tmargin-bottom: 20px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".search-title {\n");
      out.write("\tfont-size: 24px;\n");
      out.write("\tmargin-bottom: 10px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".search-summary {\n");
      out.write("\tcolor: #6c757d;\n");
      out.write("\tmargin-bottom: 20px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".search-filters {\n");
      out.write("\tdisplay: flex;\n");
      out.write("\tflex-wrap: wrap;\n");
      out.write("\tgap: 10px;\n");
      out.write("\tmargin-bottom: 20px;\n");
      out.write("\tpadding: 15px;\n");
      out.write("\tbackground-color: #f8f9fa;\n");
      out.write("\tborder-radius: 8px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".active-filter {\n");
      out.write("\tbackground-color: #e9ecef;\n");
      out.write("\tborder-radius: 20px;\n");
      out.write("\tpadding: 5px 12px;\n");
      out.write("\tfont-size: 14px;\n");
      out.write("\tdisplay: flex;\n");
      out.write("\talign-items: center;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".remove-filter {\n");
      out.write("\tmargin-left: 5px;\n");
      out.write("\tcolor: #6c757d;\n");
      out.write("\tcursor: pointer;\n");
      out.write("\tfont-size: 12px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".filter-divider {\n");
      out.write("\tcolor: #6c757d;\n");
      out.write("\tmargin: 0 5px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".search-results {\n");
      out.write("\tdisplay: grid;\n");
      out.write("\tgrid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n");
      out.write("\tgap: 20px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".product-card {\n");
      out.write("\tbackground-color: #fff;\n");
      out.write("\tborder-radius: 8px;\n");
      out.write("\toverflow: hidden;\n");
      out.write("\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n");
      out.write("\ttransition: transform 0.2s;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".product-card:hover {\n");
      out.write("\ttransform: translateY(-5px);\n");
      out.write("}\n");
      out.write("\n");
      out.write(".product-image {\n");
      out.write("\twidth: 100%;\n");
      out.write("\theight: 200px;\n");
      out.write("\tobject-fit: cover;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".product-info {\n");
      out.write("\tpadding: 15px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".product-title {\n");
      out.write("\tfont-weight: bold;\n");
      out.write("\tmargin-bottom: 10px;\n");
      out.write("\theight: 40px;\n");
      out.write("\toverflow: hidden;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".product-price {\n");
      out.write("\tcolor: #e44d26;\n");
      out.write("\tfont-weight: bold;\n");
      out.write("\tmargin-bottom: 10px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".product-status {\n");
      out.write("\tbackground-color: #f8d7da;\n");
      out.write("\tcolor: #721c24;\n");
      out.write("\tdisplay: inline-block;\n");
      out.write("\tpadding: 2px 8px;\n");
      out.write("\tborder-radius: 4px;\n");
      out.write("\tfont-size: 12px;\n");
      out.write("\tmargin-top: 5px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".empty-results {\n");
      out.write("\ttext-align: center;\n");
      out.write("\tpadding: 50px 0;\n");
      out.write("\tcolor: #6c757d;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".empty-results-icon {\n");
      out.write("\tfont-size: 48px;\n");
      out.write("\tmargin-bottom: 20px;\n");
      out.write("\tcolor: #adb5bd;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".pagination {\n");
      out.write("\tdisplay: flex;\n");
      out.write("\tjustify-content: center;\n");
      out.write("\tmargin-top: 30px;\n");
      out.write("\tlist-style-type: none;\n");
      out.write("\tpadding: 0;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".pagination li {\n");
      out.write("\tmargin: 0 5px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".pagination a {\n");
      out.write("\tdisplay: block;\n");
      out.write("\tpadding: 8px 12px;\n");
      out.write("\tbackground-color: #fff;\n");
      out.write("\tcolor: #007bff;\n");
      out.write("\ttext-decoration: none;\n");
      out.write("\tborder-radius: 4px;\n");
      out.write("\tborder: 1px solid #dee2e6;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".pagination a:hover {\n");
      out.write("\tbackground-color: #e9ecef;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".pagination .active a {\n");
      out.write("\tbackground-color: #007bff;\n");
      out.write("\tcolor: #fff;\n");
      out.write("\tborder-color: #007bff;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".pagination .disabled a {\n");
      out.write("\tcolor: #6c757d;\n");
      out.write("\tpointer-events: none;\n");
      out.write("\tbackground-color: #fff;\n");
      out.write("\tborder-color: #dee2e6;\n");
      out.write("}\n");
      out.write("\n");
      out.write("/* 검색 폼 스타일 */\n");
      out.write(".search-container {\n");
      out.write("\tflex: 1;\n");
      out.write("\tmax-width: 500px;\n");
      out.write("\tmargin: 0 20px;\n");
      out.write("\tposition: relative;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".search-form {\n");
      out.write("\tdisplay: flex;\n");
      out.write("\twidth: 100%;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".search-input {\n");
      out.write("\tflex: 1;\n");
      out.write("\tborder: 2px solid #e0e0e0;\n");
      out.write("\tborder-radius: 20px 0 0 20px;\n");
      out.write("\tpadding: 8px 15px;\n");
      out.write("\tfont-size: 14px;\n");
      out.write("\ttransition: border-color 0.3s;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".search-input:focus {\n");
      out.write("\toutline: none;\n");
      out.write("\tborder-color: #007bff;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".search-btn {\n");
      out.write("\tbackground-color: #007bff;\n");
      out.write("\tcolor: white;\n");
      out.write("\tborder: none;\n");
      out.write("\tborder-radius: 0 20px 20px 0;\n");
      out.write("\tpadding: 8px 15px;\n");
      out.write("\tcursor: pointer;\n");
      out.write("\ttransition: background-color 0.3s;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".search-btn:hover {\n");
      out.write("\tbackground-color: #0056b3;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".sort-options {\n");
      out.write("\tdisplay: flex;\n");
      out.write("\tjustify-content: flex-end;\n");
      out.write("\tmargin-bottom: 15px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".sort-option {\n");
      out.write("\tpadding: 5px 10px;\n");
      out.write("\tmargin-left: 10px;\n");
      out.write("\tbackground-color: transparent;\n");
      out.write("\tborder: 1px solid #ddd;\n");
      out.write("\tborder-radius: 4px;\n");
      out.write("\tcolor: #333;\n");
      out.write("\tcursor: pointer;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".sort-option.active {\n");
      out.write("\tbackground-color: #007bff;\n");
      out.write("\tcolor: white;\n");
      out.write("\tborder-color: #007bff;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".notification-icon-container {\n");
      out.write("\tposition: relative;\n");
      out.write("\tmargin-left: 10px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".notification-icon {\n");
      out.write("\tcolor: #333;\n");
      out.write("\tfont-size: 18px;\n");
      out.write("\ttext-decoration: none;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".notification-badge {\n");
      out.write("\tposition: absolute;\n");
      out.write("\ttop: -8px;\n");
      out.write("\tright: -8px;\n");
      out.write("\tbackground-color: #ff4136;\n");
      out.write("\tcolor: white;\n");
      out.write("\tborder-radius: 50%;\n");
      out.write("\twidth: 18px;\n");
      out.write("\theight: 18px;\n");
      out.write("\tfont-size: 12px;\n");
      out.write("\tdisplay: flex;\n");
      out.write("\talign-items: center;\n");
      out.write("\tjustify-content: center;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".footer {\n");
      out.write("\tbackground-color: #f8f9fa;\n");
      out.write("\tpadding: 20px 0;\n");
      out.write("\tmargin-top: 50px;\n");
      out.write("\tborder-top: 1px solid #e7e7e7;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".footer-content {\n");
      out.write("\tmax-width: 1200px;\n");
      out.write("\tmargin: 0 auto;\n");
      out.write("\ttext-align: center;\n");
      out.write("\tcolor: #6c757d;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".footer-links {\n");
      out.write("\tmargin-top: 10px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".footer-links a {\n");
      out.write("\tcolor: #6c757d;\n");
      out.write("\ttext-decoration: none;\n");
      out.write("\tmargin: 0 5px;\n");
      out.write("}\n");
      out.write("\n");
      out.write(".footer-links a:hover {\n");
      out.write("\ttext-decoration: underline;\n");
      out.write("}\n");
      out.write("</style>\n");
      out.write("</head>\n");
      out.write("<body>\n");
      out.write("\t<!-- 헤더 포함 -->\n");
      out.write("\t<div class=\"header\">\n");
      out.write("\t\t<div class=\"header-content\">\n");
      out.write("\t\t\t<div class=\"header-left\">\n");
      out.write("\t\t\t\t<h1>\n");
      out.write("\t\t\t\t\t<a href=\"index\" style=\"text-decoration: none; color: inherit;\">옥션\n");
      out.write("\t\t\t\t\t\t플랫폼</a>\n");
      out.write("\t\t\t\t</h1>\n");
      out.write("\t\t\t</div>\n");
      out.write("\n");
      out.write("\t\t\t<!-- 검색 기능 -->\n");
      out.write("\t\t\t<div class=\"search-container\">\n");
      out.write("\t\t\t\t<form action=\"search\" method=\"get\" class=\"search-form\">\n");
      out.write("\t\t\t\t\t<input type=\"text\" name=\"keyword\" class=\"search-input\"\n");
      out.write("\t\t\t\t\t\tplaceholder=\"찾고 싶은 상품을 검색해보세요\"\n");
      out.write("\t\t\t\t\t\tvalue=\"");
      out.print(keyword != null ? keyword : "");
      out.write("\">\n");
      out.write("\t\t\t\t\t<button type=\"submit\" class=\"search-btn\">\n");
      out.write("\t\t\t\t\t\t<i class=\"fas fa-search\"></i>\n");
      out.write("\t\t\t\t\t</button>\n");
      out.write("\t\t\t\t</form>\n");
      out.write("\t\t\t</div>\n");
      out.write("\n");
      out.write("\t\t\t<div class=\"header-right\">\n");
      out.write("\t\t\t\t");

				if (userId != null) {
				
      out.write("\n");
      out.write("\t\t\t\t<span class=\"welcome-msg\">");
      out.print(userId);
      out.write("님 환영합니다</span> <a href=\"mypage\"\n");
      out.write("\t\t\t\t\tclass=\"header-btn\">마이페이지</a> <a href=\"receivedreviews\"\n");
      out.write("\t\t\t\t\tclass=\"header-btn\">받은 리뷰 보기</a> <a href=\"reviewform\"\n");
      out.write("\t\t\t\t\tclass=\"header-btn\">리뷰 작성하기</a>\n");
      out.write("\t\t\t\t<form action=\"logout\" method=\"post\" style=\"display: inline;\">\n");
      out.write("\t\t\t\t\t<button type=\"submit\" class=\"header-btn\"\n");
      out.write("\t\t\t\t\t\tstyle=\"cursor: pointer; background: none; border: 1px solid #ddd; padding: 5px 10px; border-radius: 4px;\">로그아웃</button>\n");
      out.write("\t\t\t\t</form>\n");
      out.write("\n");
      out.write("\t\t\t\t<!-- 알림 아이콘 추가 -->\n");
      out.write("\t\t\t\t<div class=\"notification-icon-container\">\n");
      out.write("\t\t\t\t\t<a href=\"notifications\" class=\"notification-icon\"> <i\n");
      out.write("\t\t\t\t\t\tclass=\"fa fa-bell\"></i> ");

 // 미읽은 알림 개수 가져오기
 int unreadNotificationCount = 0;
 try {
 	Notification.NotificationDAO notificationDAO = new Notification.NotificationDAO();
 	unreadNotificationCount = notificationDAO.getUnreadNotificationCount(userId);
 } catch (Exception e) {
 	e.printStackTrace();
 }
 if (unreadNotificationCount > 0) {
 
      out.write(" <span class=\"notification-badge\">");
      out.print(unreadNotificationCount);
      out.write("</span>\n");
      out.write("\t\t\t\t\t\t");

						}
						
      out.write("\n");
      out.write("\t\t\t\t\t</a>\n");
      out.write("\t\t\t\t</div>\n");
      out.write("\t\t\t\t");

				} else {
				
      out.write("\n");
      out.write("\t\t\t\t<a href=\"login\" class=\"header-btn\">로그인</a> <a href=\"signup\"\n");
      out.write("\t\t\t\t\tclass=\"header-btn\">회원가입</a>\n");
      out.write("\t\t\t\t");

				}
				
      out.write("\n");
      out.write("\t\t\t</div>\n");
      out.write("\t\t</div>\n");
      out.write("\t</div>\n");
      out.write("\n");
      out.write("\t<div class=\"content\">\n");
      out.write("\t\t<div class=\"search-header\">\n");
      out.write("\t\t\t<h1 class=\"search-title\">\n");
      out.write("\t\t\t\t");

				if (keyword != null && !keyword.trim().isEmpty()) {
				
      out.write("\n");
      out.write("\t\t\t\t\"");
      out.print(keyword);
      out.write("\" 검색 결과\n");
      out.write("\t\t\t\t");

				} else {
				
      out.write("\n");
      out.write("\t\t\t\t전체 상품 검색\n");
      out.write("\t\t\t\t");

				}
				
      out.write("\n");
      out.write("\t\t\t</h1>\n");
      out.write("\t\t\t<div class=\"search-summary\">\n");
      out.write("\t\t\t\t");

				if (totalItems > 0) {
				
      out.write("\n");
      out.write("\t\t\t\t총\n");
      out.write("\t\t\t\t");
      out.print(totalItems);
      out.write("개의 상품이 검색되었습니다.\n");
      out.write("\t\t\t\t");

				} else {
				
      out.write("\n");
      out.write("\t\t\t\t검색 결과가 없습니다.\n");
      out.write("\t\t\t\t");

				}
				
      out.write("\n");
      out.write("\t\t\t</div>\n");
      out.write("\n");
      out.write("\t\t\t<!-- 활성화된 필터 표시 -->\n");
      out.write("\t\t\t");

			if (category != null || price != null || status != null || sort != null) {
			
      out.write("\n");
      out.write("\t\t\t<div class=\"search-filters\">\n");
      out.write("\t\t\t\t");

				if (category != null && !category.equals("all") && !category.trim().isEmpty()) {
				
      out.write("\n");
      out.write("\t\t\t\t<div class=\"active-filter\">\n");
      out.write("\t\t\t\t\t카테고리:\n");
      out.write("\t\t\t\t\t");

				String categoryName = category;
				if (category.equals("electronics"))
					categoryName = "전자기기";
				else if (category.equals("fashion"))
					categoryName = "패션";
				else if (category.equals("books"))
					categoryName = "도서";
				else if (category.equals("beauty"))
					categoryName = "뷰티/미용";
				else if (category.equals("sports"))
					categoryName = "스포츠/레저";
				else if (category.equals("appliances"))
					categoryName = "가전제품";
				
      out.write("\n");
      out.write("\t\t\t\t\t");
      out.print(categoryName);
      out.write("\n");
      out.write("\t\t\t\t\t<a\n");
      out.write("\t\t\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=");
      out.print(sort != null ? sort : "");
      out.write("\"\n");
      out.write("\t\t\t\t\t\tclass=\"remove-filter\"> <i class=\"fas fa-times\"></i>\n");
      out.write("\t\t\t\t\t</a>\n");
      out.write("\t\t\t\t</div>\n");
      out.write("\t\t\t\t");

				}
				
      out.write("\n");
      out.write("\n");
      out.write("\t\t\t\t");

				if (price != null && !price.trim().isEmpty()) {
				
      out.write("\n");
      out.write("\t\t\t\t<div class=\"active-filter\">\n");
      out.write("\t\t\t\t\t가격:\n");
      out.write("\t\t\t\t\t");

				String priceText = "";
				if (price.equals("0-50000"))
					priceText = "5만원 이하";
				else if (price.equals("50000-100000"))
					priceText = "5만원~10만원";
				else if (price.equals("100000-300000"))
					priceText = "10만원~30만원";
				else if (price.equals("300000-"))
					priceText = "30만원 이상";
				
      out.write("\n");
      out.write("\t\t\t\t\t");
      out.print(priceText);
      out.write("\n");
      out.write("\t\t\t\t\t<a\n");
      out.write("\t\t\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=");
      out.print(sort != null ? sort : "");
      out.write("\"\n");
      out.write("\t\t\t\t\t\tclass=\"remove-filter\"> <i class=\"fas fa-times\"></i>\n");
      out.write("\t\t\t\t\t</a>\n");
      out.write("\t\t\t\t</div>\n");
      out.write("\t\t\t\t");

				}
				
      out.write("\n");
      out.write("\n");
      out.write("\t\t\t\t");

				if (status != null && !status.trim().isEmpty()) {
				
      out.write("\n");
      out.write("\t\t\t\t<div class=\"active-filter\">\n");
      out.write("\t\t\t\t\t상태:\n");
      out.write("\t\t\t\t\t");

				String statusText = "";
				if (status.equals("onsale"))
					statusText = "판매중";
				else if (status.equals("closed"))
					statusText = "경매종료";
				
      out.write("\n");
      out.write("\t\t\t\t\t");
      out.print(statusText);
      out.write("\n");
      out.write("\t\t\t\t\t<a\n");
      out.write("\t\t\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&sort=");
      out.print(sort != null ? sort : "");
      out.write("\"\n");
      out.write("\t\t\t\t\t\tclass=\"remove-filter\"> <i class=\"fas fa-times\"></i>\n");
      out.write("\t\t\t\t\t</a>\n");
      out.write("\t\t\t\t</div>\n");
      out.write("\t\t\t\t");

				}
				
      out.write("\n");
      out.write("\n");
      out.write("\t\t\t\t");

				if (sort != null && !sort.trim().isEmpty() && !sort.equals("relevance")) {
				
      out.write("\n");
      out.write("\t\t\t\t<div class=\"active-filter\">\n");
      out.write("\t\t\t\t\t정렬:\n");
      out.write("\t\t\t\t\t");

				String sortText = "";
				if (sort.equals("priceAsc"))
					sortText = "가격 낮은순";
				else if (sort.equals("priceDesc"))
					sortText = "가격 높은순";
				else if (sort.equals("newest"))
					sortText = "최신순";
				else if (sort.equals("endingSoon"))
					sortText = "마감임박순";
				
      out.write("\n");
      out.write("\t\t\t\t\t");
      out.print(sortText);
      out.write("\n");
      out.write("\t\t\t\t\t<a\n");
      out.write("\t\t\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("\"\n");
      out.write("\t\t\t\t\t\tclass=\"remove-filter\"> <i class=\"fas fa-times\"></i>\n");
      out.write("\t\t\t\t\t</a>\n");
      out.write("\t\t\t\t</div>\n");
      out.write("\t\t\t\t");

				}
				
      out.write("\n");
      out.write("\n");
      out.write("\t\t\t\t");

				if ((category != null && !category.equals("all") && !category.trim().isEmpty())
						|| (price != null && !price.trim().isEmpty()) || (status != null && !status.trim().isEmpty())
						|| (sort != null && !sort.trim().isEmpty() && !sort.equals("relevance"))) {
				
      out.write("\n");
      out.write("\t\t\t\t<a href=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("\"\n");
      out.write("\t\t\t\t\tclass=\"active-filter\"\n");
      out.write("\t\t\t\t\tstyle=\"background-color: #f8d7da; color: #721c24;\"> 모든 필터 초기화 <i\n");
      out.write("\t\t\t\t\tclass=\"fas fa-times\"></i>\n");
      out.write("\t\t\t\t</a>\n");
      out.write("\t\t\t\t");

				}
				
      out.write("\n");
      out.write("\t\t\t</div>\n");
      out.write("\t\t\t");

			}
			
      out.write("\n");
      out.write("\n");
      out.write("\t\t\t<!-- 정렬 옵션 -->\n");
      out.write("\t\t\t<div class=\"sort-options\">\n");
      out.write("\t\t\t\t<a\n");
      out.write("\t\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=relevance\"\n");
      out.write("\t\t\t\t\tclass=\"sort-option ");
      out.print((sort == null || sort.equals("relevance")) ? "active" : "");
      out.write("\">관련성순</a>\n");
      out.write("\t\t\t\t<a\n");
      out.write("\t\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=priceAsc\"\n");
      out.write("\t\t\t\t\tclass=\"sort-option ");
      out.print((sort != null && sort.equals("priceAsc")) ? "active" : "");
      out.write("\">가격\n");
      out.write("\t\t\t\t\t낮은순</a> <a\n");
      out.write("\t\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=priceDesc\"\n");
      out.write("\t\t\t\t\tclass=\"sort-option ");
      out.print((sort != null && sort.equals("priceDesc")) ? "active" : "");
      out.write("\">가격\n");
      out.write("\t\t\t\t\t높은순</a> <a\n");
      out.write("\t\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=newest\"\n");
      out.write("\t\t\t\t\tclass=\"sort-option ");
      out.print((sort != null && sort.equals("newest")) ? "active" : "");
      out.write("\">최신순</a>\n");
      out.write("\t\t\t\t<a\n");
      out.write("\t\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=endingSoon\"\n");
      out.write("\t\t\t\t\tclass=\"sort-option ");
      out.print((sort != null && sort.equals("endingSoon")) ? "active" : "");
      out.write("\">마감임박순</a>\n");
      out.write("\t\t\t</div>\n");
      out.write("\t\t</div>\n");
      out.write("\n");
      out.write("\t\t");

		if (searchResults != null && !searchResults.isEmpty()) {
		
      out.write("\n");
      out.write("\t\t<div class=\"search-results\">\n");
      out.write("\t\t\t");

			for (ProductDTO product : searchResults) {
			
      out.write("\n");
      out.write("\t\t\t<div class=\"product-card\">\n");
      out.write("\t\t\t\t<a href=\"buyingproduct?product_id=");
      out.print(product.getProduct_id());
      out.write("\">\n");
      out.write("\t\t\t\t\t<img\n");
      out.write("\t\t\t\t\tsrc=\"");
      out.print(request.getContextPath());
      out.write('/');
      out.print(product.getImage_path() != null ? product.getImage_path() : "images/default.jpg");
      out.write("\"\n");
      out.write("\t\t\t\t\talt=\"");
      out.print(product.getTitle());
      out.write("\" class=\"product-image\">\n");
      out.write("\t\t\t\t</a>\n");
      out.write("\t\t\t\t<div class=\"product-info\">\n");
      out.write("\t\t\t\t\t<div class=\"product-title\">");
      out.print(product.getTitle());
      out.write("</div>\n");
      out.write("\t\t\t\t\t<div class=\"product-price\">");
      out.print(product.getPrice());
      out.write("원\n");
      out.write("\t\t\t\t\t</div>\n");
      out.write("\t\t\t\t\t");

					if ("경매종료".equals(product.getStatus())) {
					
      out.write("\n");
      out.write("\t\t\t\t\t<div class=\"product-status\">경매 종료</div>\n");
      out.write("\t\t\t\t\t");

					}
					
      out.write("\n");
      out.write("\t\t\t\t</div>\n");
      out.write("\t\t\t</div>\n");
      out.write("\t\t\t");

			}
			
      out.write("\n");
      out.write("\t\t</div>\n");
      out.write("\n");
      out.write("\t\t<!-- 페이지네이션 -->\n");
      out.write("\t\t");

		if (totalPages > 1) {
		
      out.write("\n");
      out.write("\t\t<ul class=\"pagination\">\n");
      out.write("\t\t\t<li class=\"");
      out.print(currentPage == 1 ? "disabled" : "");
      out.write("\"><a\n");
      out.write("\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=");
      out.print(sort != null ? sort : "");
      out.write("&page=");
      out.print(currentPage - 1);
      out.write("\">\n");
      out.write("\t\t\t\t\t<i class=\"fas fa-chevron-left\"></i>\n");
      out.write("\t\t\t</a></li>\n");
      out.write("\n");
      out.write("\t\t\t");

			int startPage = Math.max(1, currentPage - 2);
			int endPage = Math.min(totalPages, startPage + 4);

			if (startPage > 1) {
			
      out.write("\n");
      out.write("\t\t\t<li><a\n");
      out.write("\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=");
      out.print(sort != null ? sort : "");
      out.write("&page=1\">1</a></li>\n");
      out.write("\t\t\t");

			if (startPage > 2) {
			
      out.write("\n");
      out.write("\t\t\t<li class=\"disabled\"><a>...</a></li>\n");
      out.write("\t\t\t");

			}
			
      out.write("\n");
      out.write("\t\t\t");

			}
			
      out.write("\n");
      out.write("\n");
      out.write("\t\t\t");

			for (int i = startPage; i <= endPage; i++) {
			
      out.write("\n");
      out.write("\t\t\t<li class=\"");
      out.print(i == currentPage ? "active" : "");
      out.write("\"><a\n");
      out.write("\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=");
      out.print(sort != null ? sort : "");
      out.write("&page=");
      out.print(i);
      out.write('"');
      out.write('>');
      out.print(i);
      out.write("</a>\n");
      out.write("\t\t\t</li>\n");
      out.write("\t\t\t");

			}
			
      out.write("\n");
      out.write("\n");
      out.write("\t\t\t");

			if (endPage < totalPages) {
				if (endPage < totalPages - 1) {
			
      out.write("\n");
      out.write("\t\t\t<li class=\"disabled\"><a>...</a></li>\n");
      out.write("\t\t\t");

			}
			
      out.write("\n");
      out.write("\t\t\t<li><a\n");
      out.write("\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=");
      out.print(sort != null ? sort : "");
      out.write("&page=");
      out.print(totalPages);
      out.write('"');
      out.write('>');
      out.print(totalPages);
      out.write("</a></li>\n");
      out.write("\t\t\t");

			}
			
      out.write("\n");
      out.write("\n");
      out.write("\t\t\t<li class=\"");
      out.print(currentPage == totalPages ? "disabled" : "");
      out.write("\"><a\n");
      out.write("\t\t\t\thref=\"search?keyword=");
      out.print(keyword != null ? keyword : "");
      out.write("&category=");
      out.print(category != null ? category : "");
      out.write("&price=");
      out.print(price != null ? price : "");
      out.write("&status=");
      out.print(status != null ? status : "");
      out.write("&sort=");
      out.print(sort != null ? sort : "");
      out.write("&page=");
      out.print(currentPage + 1);
      out.write("\">\n");
      out.write("\t\t\t\t\t<i class=\"fas fa-chevron-right\"></i>\n");
      out.write("\t\t\t</a></li>\n");
      out.write("\t\t</ul>\n");
      out.write("\t\t");

		}
		
      out.write('\n');
      out.write('	');
      out.write('	');

		} else {
		
      out.write("\n");
      out.write("\t\t<div class=\"empty-results\">\n");
      out.write("\t\t\t<div class=\"empty-results-icon\">\n");
      out.write("\t\t\t\t<i class=\"fas fa-search\"></i>\n");
      out.write("\t\t\t</div>\n");
      out.write("\t\t\t<h2>검색 결과가 없습니다</h2>\n");
      out.write("\t\t\t<p>다른 검색어를 입력하거나 필터를 변경해 보세요.</p>\n");
      out.write("\t\t\t<a href=\"index\" class=\"header-btn\"\n");
      out.write("\t\t\t\tstyle=\"display: inline-block; margin-top: 20px;\">메인으로 돌아가기</a>\n");
      out.write("\t\t</div>\n");
      out.write("\t\t");

		}
		
      out.write("\n");
      out.write("\t</div>\n");
      out.write("\n");
      out.write("\t<!-- 푸터 -->\n");
      out.write("\t<div class=\"footer\">\n");
      out.write("\t\t<div class=\"footer-content\">\n");
      out.write("\t\t\t<p>&copy; 2024 옥션 플랫폼. All rights reserved.</p>\n");
      out.write("\t\t\t<div class=\"footer-links\">\n");
      out.write("\t\t\t\t<a href=\"#\">이용약관</a> | <a href=\"#\">개인정보처리방침</a> | <a href=\"#\">고객센터</a>\n");
      out.write("\t\t\t\t");

				if (userId != null) {
				
      out.write("\n");
      out.write("\t\t\t\t| <a href=\"receivedreviews\">받은 리뷰 보기</a> | <a href=\"reviewform\">리뷰\n");
      out.write("\t\t\t\t\t작성하기</a>\n");
      out.write("\t\t\t\t");

				}
				
      out.write("\n");
      out.write("\t\t\t</div>\n");
      out.write("\t\t</div>\n");
      out.write("\t</div>\n");
      out.write("</body>\n");
      out.write("</html>\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
